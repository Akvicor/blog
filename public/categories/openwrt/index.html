<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="OpenWrt - https://blog.akvicor.com/categories/openwrt/">
    <meta name="author" content="Akvicor - https://blog.akvicor.com/">
	
	<meta name="baidu-site-verification" content="codeva-84NnEJvKGE" />
    
    <meta name="msvalidate.01" content="23AB88DCE901A2BD829B9DC162576D33" />
    <title>OpenWrt</title>
    
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
	<script defer src="https://analy.akvicor.com/script.js" data-website-id="c0cbafdd-207e-431e-a252-4a64c31d98b9"></script>
    
    <link rel="stylesheet" href="https://blog.akvicor.com/style.min.3acf5e51a9f409d16acec003b620bc77f2bf308e2a40b5221d228bb9a57f9eee.css">
    
    <script type="text/javascript" src="/main.js" defer></script>
    <script src="/js/hide_and_seek.js"></script>
    <link rel="stylesheet" href="/css/hide_and_seek.css">
    <link rel="stylesheet" href="/css/heimu.css">
	
		<script>
			console.log(String.raw`
          _           _                _ 
    /\   | |         (_)              | |
   /  \  | | ____   ___  ___ ___  _ __| |
  / /\ \ | |/ /\ \ / / |/ __/ _ \| '__| |
 / ____ \|   <  \ V /| | (_| (_) | |  |_|
/_/    \_\_|\_\  \_/ |_|\___\___/|_|  (_)`);
		</script>
		<script>
			try{
				if(window.console&&window.console.log) {
					console.log("%cFor the Horde! %cFor the Azeroth!","color:red","color:blue");
					console.log("%c火墙火墙火墙火墙！","color:red");
					console.log("%c快打大怪！","color:red");
					console.log("%c快打断！","color:red");
					console.log("%c注意脚下！","color:red");
					console.log("%c快躲开！","color:red");
					console.log("%c震慑波！","color:red");
					console.log("%c快转身！","color:red");
					console.log("%c注意减伤！","color:red");
					console.log("%c<Deadly Boss Mods> %cCombat against 10 Player - Garrosh Hellscream(1%) ended after 8 minutes ad 19 seconds. you have 3 total wipes on this difficulty.","color:red","color:blue");
				}
			}
			catch(e){};
        </script>
	
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script>
	
		
		<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$math_inline$','$math_inline$'], ['\\(','\\)']],
				displayMath: [['$math_noinline$','$math_noinline$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script>
	

	
	
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css">
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js"></script>
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
		
		
		<script>
			document.addEventListener("DOMContentLoaded", function() {
					renderMathInElement(document.body, {
							delimiters: [
									{left: "$math_noinline$", right: "$math_noinline$", display: true},
									{left: "$math_inline$", right: "$math_inline$", display: false}
							]
					});
			});
			</script>
	
    
</head>
<body class="active-animate ">
        <div id="header"><div class="container-header">
    <div id="vars" class="container-vars" style="display: none;">
	{
		"isSingleColumnOfPostList": true,
		"hasFoldAllCodeBlocks": false,
		"svgColor": "",
		"en": false,
		"dark": false
	}
</div>
    <h1 class="title">
        
            OpenWrt
            
        
    </h1>

    <div class="container-breadcrumb-nav">
    
    <div class="breadcrumb-nav-bar">
        <div><a href="/"><svg t="1656411084410" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2954" width="16" height="16"><path d="M947.5 390.6l-377-290c-34.5-26.5-82.6-26.5-117.1 0l-377 290c-14 10.8-16.6 30.9-5.9 44.9 10.8 14 30.9 16.6 44.9 5.9l28.5-21.9V768c0 88.2 71.8 160 160 160h80c35.3 0 64-28.7 64-64V640c0-17.6 14.4-32 32-32h64c17.6 0 32 14.4 32 32v224c0 35.3 28.7 64 64 64h80c88.2 0 160-71.8 160-160V419.4l28.5 21.9c5.8 4.5 12.7 6.6 19.5 6.6 9.6 0 19.1-4.3 25.4-12.5 10.8-13.9 8.2-34-5.8-44.8zM816 768c0 52.9-43.1 96-96 96h-80V640c0-52.9-43.1-96-96-96h-64c-52.9 0-96 43.1-96 96v224h-80c-52.9 0-96-43.1-96-96V370.2l284.5-218.8c11.5-8.8 27.5-8.8 39 0L816 370.2V768z" fill="#6c757d" p-id="2955"></path></svg></a></div>
        <div><a href="/nav"><svg t="1656411531924" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5827" width="16" height="16"><path d="M849.59197473 125.23018519L139.22930586 391.72854662a23.35052669 23.35052669 0 0 0-14.95414244 21.65490745c-0.12257519 9.70384955 5.61801843 18.46795771 14.40255493 22.04306141l318.42928099 129.25528056 119.51057092 320.39047893c3.06437293 8.23295069 10.35758221 13.89182751 18.7335381 14.87242563l2.7170774 0.14300521a22.79893918 22.79893918 0 0 0 21.20546682-15.36272638l259.51158924-729.54564933a23.8612558 23.8612558 0 0 0-5.31158128-24.55584682 22.3290685 22.3290685 0 0 0-23.9021142-5.43415649zM793.65694081 211.64552314l-196.63064161 552.75171747-91.91077952-246.37564122-253.62799211-102.96295445 542.16941324-203.4131218z" p-id="5828" fill="#6c757d"></path></svg></a></div>
        <div><a href="/search"><svg t="1656411627509" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1730" width="14" height="14"><path d="M469.333333 85.333333c211.968 0 384 172.032 384 384s-172.032 384-384 384-384-172.032-384-384 172.032-384 384-384z m0 682.666667c164.992 0 298.666667-133.674667 298.666667-298.666667 0-165.034667-133.674667-298.666667-298.666667-298.666666-165.034667 0-298.666667 133.632-298.666666 298.666666 0 164.992 133.632 298.666667 298.666666 298.666667z m362.026667 3.029333l120.704 120.661334-60.373333 60.373333-120.661334-120.704 60.330667-60.330667z" p-id="1731" fill="#6c757d"></path></svg></a></div>
        <div><a href="/posts"><svg t="1656411724198" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5655" width="12" height="12"><path d="M811.705761 1024H212.294239c-93.1199 0-174.823046-87.570975-174.823046-187.387854V162.322018C37.471193 69.776145 112.604921 0 212.294239 0H596.190595l7.015883 5.93161c111.74388 95.479788 185.857116 170.741078 279.614824 266.093304 29.65805 30.040735 61.165743 62.122454 96.436499 97.393211l7.271006 7.334787v459.859234c-0.063781 99.816879-81.703145 187.387854-174.823046 187.387854zM212.294239 49.94033c-72.391155 0-124.882716 47.261538-124.882716 112.381688v674.290128c0 71.94469 59.507443 137.383743 124.882716 137.383743h599.411522c65.311492 0 124.882716-65.439053 124.882716-137.383743V397.417876c-32.528184-32.464404-61.73977-62.250016-89.356836-90.377328-90.951355-92.418312-163.278729-165.957521-269.601245-257.163999H212.294239z" fill="#6c757d" p-id="5656"></path><path d="M936.588477 449.526752h-212.326129c-99.753099 0-187.324073-81.703145-187.324073-174.823046V49.94033a25.002055 25.002055 0 0 1 49.94033 0v224.763376c0 65.311492 65.502834 124.882716 137.383743 124.882716h212.326129a25.002055 25.002055 0 1 1 0 49.94033z" fill="#6c757d" p-id="5657"></path></svg></a></div>
        <div><a href="/archive"><svg t="1656411795742" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7334" width="12" height="12"><path d="M884.224 522.24H504.32V141.824c0-16.896-13.824-30.72-30.72-30.72-120.32 0-233.472 47.616-317.952 134.144S26.112 445.952 29.184 566.784c2.56 114.688 49.152 222.72 131.072 304.128 81.92 81.408 189.952 128 304.64 130.56h10.24c117.76 0 227.84-45.568 312.32-128.512 86.528-85.504 133.632-199.68 132.608-321.024-0.512-2.048-1.536-29.696-35.84-29.696z m-140.288 307.712c-74.752 73.728-173.056 112.64-277.504 110.592-205.824-4.608-370.688-169.472-375.296-374.784-3.072-104.448 35.84-202.752 108.544-277.504 65.536-67.072 151.552-107.52 243.712-114.688v378.88c0 16.896 13.824 30.72 30.72 30.72 129.024 0 311.296 0 382.976 0.512-6.144 93.184-46.08 179.712-113.152 246.272z" fill="#6c757d" p-id="7335"></path><path d="M603.136 11.264c-8.192-0.512-15.872 3.072-22.016 8.704-5.632 5.632-9.216 13.824-9.216 22.016v378.88c0 16.896 13.824 30.72 30.72 30.72h378.88c16.896 0 30.72-13.824 30.72-30.72 0-223.744-183.808-407.552-409.088-409.6z m30.208 378.88V74.24c167.424 16.384 301.056 150.016 315.904 315.904h-315.904z" fill="#6c757d" p-id="7336"></path></svg></a></div>
        <div id="light-dark" style="cursor: pointer;"><a><svg t="1656411842215" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5086" width="12" height="12"><path d="M1007.492874 384.513055c-8.795694-34.58307-21.189627-67.666874-36.682043-99.05151-2.698679-5.397358-10.894667-3.498287-10.894666 2.598728v0.299853c0 32.484098-6.896624 63.868734-19.890263 92.554691-10.694764 23.488501-25.487523 45.077933-43.978471 64.068635-41.779547 42.679107-99.05151 66.967217-158.722299 67.26707-61.869712 0.299853-119.941284-24.188159-162.920244-68.966238-40.280281-41.979449-62.56937-98.251902-62.269516-156.323473 0.399804-59.270984 23.588452-114.94373 65.567901-156.823229 19.59041-19.59041 42.179351-35.082826 66.667364-46.077443C672.956643 71.166451 704.041426 64.469729 736.125719 64.469729h1.299364c6.097015 0 8.096037-8.096037 2.598728-10.794715C708.739126 37.982696 675.655322 25.488812 641.172203 16.493216 599.492607 5.598549 555.714038-0.098662 510.536154 0.001289 222.37722 0.700947-7.41029 237.38508 0.185992 525.444064c7.096526 271.667008 225.889418 490.559851 497.456474 497.856279 287.559228 7.796183 524.14341-220.891864 525.842579-508.551044 0.299853-44.977981-5.297407-88.656599-15.992171-130.236244z m-83.15929 301.552378c-22.588942 53.27392-54.873137 101.250434-95.953027 142.330323-41.179841 41.179841-89.056403 73.464036-142.330324 95.953027-55.172991 23.288599-113.744317 35.182777-174.314666 35.182777s-119.141675-11.794226-174.314666-35.182777c-53.27392-22.588942-101.250434-54.873137-142.330323-95.953027-41.179841-41.179841-73.464036-89.056403-95.953027-142.330323C75.749001 630.892442 63.954774 572.221164 63.954774 511.750767s11.794226-119.141675 35.182777-174.314666c22.588942-53.27392 54.873137-101.250434 95.953027-142.330323 41.179841-41.179841 89.056403-73.464036 142.330323-95.953027C392.593892 75.7642 451.26517 63.969974 511.735567 63.969974c13.99315 0 27.886348 0.599706 41.679596 1.89907C489.246577 118.643209 448.266638 198.704016 448.266638 288.360126c0 159.022152 128.836929 287.859081 287.859081 287.859081 89.156354 0 168.817357-40.580134 221.691473-104.149015 1.099462 13.09359 1.699168 26.387082 1.699168 39.680575 0 60.470397-11.794226 119.141675-35.182776 174.314666z" p-id="5087" fill="#6c757d"></path></svg></a></div>
        
    </div>

    
</div>

    
    
</div>
</div>
        <div id="content">
<div class="container-main container-list">
    <div class="content">
        
    </div>

     
        <div class="count">共有 10 篇文章</div>
    
    
    <div class="list list-single-col">
        
        
        <div class="recentf">
            <div class="desc">📅  最近更新 </div>
            
                
                <div class="rec-post">
                    <div class="rec-post-item">
                        <a href="https://blog.akvicor.com/posts/ssl/pem/">生成cert.pem和key.pem</a>
                    </div>
                </div>
                
            
                
                <div class="rec-post">
                    <div class="rec-post-item">
                        <a href="https://blog.akvicor.com/posts/aos32/gb2312/">AOS32 显示中文字符GB2312</a>
                    </div>
                </div>
                
            
                
                <div class="rec-post">
                    <div class="rec-post-item">
                        <a href="https://blog.akvicor.com/posts/linux/wireguard/">Wireguard Mesh 组网</a>
                    </div>
                </div>
                
            
                
                <div class="rec-post">
                    <div class="rec-post-item">
                        <a href="https://blog.akvicor.com/posts/linux/ufw_forward/">Linux UFW端口转发</a>
                    </div>
                </div>
                
            
                
                <div class="rec-post">
                    <div class="rec-post-item">
                        <a href="https://blog.akvicor.com/posts/hugo/add_comment/">添加评论功能 utterances和isso</a>
                    </div>
                </div>
                
            
                
                <div class="rec-post">
                    <div class="rec-post-item">
                        <a href="https://blog.akvicor.com/posts/docker/network/">修改Docker容器占用的IP段</a>
                    </div>
                </div>
                
            
                
                <div class="rec-post">
                    <div class="rec-post-item">
                        <a href="https://blog.akvicor.com/posts/openwrt/install/">Install OpenWrt/QWRT</a>
                    </div>
                </div>
                
            
                
                <div class="rec-post">
                    <div class="rec-post-item">
                        <a href="https://blog.akvicor.com/posts/linux/nfs/">NFS 挂载文件系统</a>
                    </div>
                </div>
                
            
        </div>
        
    
        
        
        <div class="item" >
           
            
            <a href="https://blog.akvicor.com/posts/openwrt/install/">
                <span> <img src="/imgs/icons/post-3.svg" width="16" /> </span>
                <span> Install OpenWrt/QWRT <sup></sup></span>
            </a>

            
            <div class="desc">
                <span class="date">
                    
                    
                    2024-03-24
                </span>
                <span class="date">
                    
                    
                    - 2025-03-16
                </span>
            </div>
            
            
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/openwrt">OpenWrt</a>
			
		</div>
		<div class="tag">
			
			
			
		</div>
	</div>
</div><div class="summary"><h2 id="扩充固件">扩充固件</h2>
<p>将.img文件中的分区使用fdisk扩充7G</p>
<h2 id="写入固件">写入固件</h2>
<h2 id="启用魔法">启用魔法</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#6639ba">echo</span> 0xDEADBEEF &gt; /etc/config/google_fu_mode
</span></span></code></pre></div><h2 id="ssrp-添加socks5">SSRP 添加Socks5</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>opkg update
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>opkg install ipt2socks
</span></span></code></pre></div></div>
				
            

        </div>
        
    
        
        
        <div class="item" >
           
            
            <a href="https://blog.akvicor.com/posts/openwrt/pptp_vpn/">
                <span> <img src="/imgs/icons/post-3.svg" width="16" /> </span>
                <span> PPTP VPN <sup></sup></span>
            </a>

            
            <div class="desc">
                <span class="date">
                    
                    
                    2023-07-22
                </span>
                <span class="date">
                    
                    
                    - 2024-09-18
                </span>
            </div>
            
            
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/openwrt">OpenWrt</a>
			
		</div>
		<div class="tag">
			
			
			
		</div>
	</div>
</div><div class="summary"><h2 id="服务端家庭宽带路由器架设">服务端（家庭宽带路由器架设</h2>
<ol>
<li>设置PPT服务器IP为路由器IP <code>172.16.1.1</code></li>
<li>客户端分配的ip范围 <code>172.16.1.200-209</code></li>
<li>设置DNS <code>172.16.1.1</code></li>
<li>设置用户名和密码</li>
<li>修改防火墙常规设置，<strong>转发</strong>由<strong>拒绝</strong>改为<strong>接受</strong>，否则客户端连接后无法通过服务端访问外部网络。</li>
</ol>
<h2 id="客户端">客户端</h2>
<h3 id="安卓">安卓</h3>
<ol>
<li>服务器地址 <code>home.akvicor.com</code></li>
<li>选中 PPP encryption (MPPE)</li>
<li>填写用户名和密码</li>
</ol>
<p><strong>若无网络可以尝试设置以下选项</strong></p></div>
				
				
				<div class="read-more">
				  <a href="/posts/openwrt/pptp_vpn/">查看更多…</a>
				</div>
				
            

        </div>
        
    
        
        
        <div class="item" >
           
            
            <a href="https://blog.akvicor.com/posts/openwrt/ttyd_ssl/">
                <span> <img src="/imgs/icons/post-3.svg" width="16" /> </span>
                <span> TTYD 开启SSL <sup></sup></span>
            </a>

            
            <div class="desc">
                <span class="date">
                    
                    
                    2023-06-28
                </span>
                <span class="date">
                    
                    
                    - 2024-09-18
                </span>
            </div>
            
            
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/openwrt">OpenWrt</a>
			
		</div>
		<div class="tag">
			
			
			
		</div>
	</div>
</div><div class="summary"><p>修改<code>/etc/config/ttyd</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>config ttyd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>        option interface &#39;@lan&#39;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>        option command &#39;/bin/login&#39;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>        option ssl &#39;true&#39;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>        option ssl_cert &#39;/viry/cert/akvicor.com.crt&#39;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>        option ssl_key &#39;/viry/cert/akvicor.com.key&#39;
</span></span></code></pre></div></div>
				
            

        </div>
        
    
        
        
        <div class="item" >
           
            
            <a href="https://blog.akvicor.com/posts/openwrt/replace_uhttp_with_caddy/">
                <span> <img src="/imgs/icons/post-3.svg" width="16" /> </span>
                <span> OpenWrt管理后台使用Caddy代替uhttpd <sup></sup></span>
            </a>

            
            <div class="desc">
                <span class="date">
                    
                    
                    2023-06-28
                </span>
                <span class="date">
                    
                    
                    - 2024-09-18
                </span>
            </div>
            
            
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/openwrt">OpenWrt</a>
			
		</div>
		<div class="tag">
			
			
			
		</div>
	</div>
</div><div class="summary"><h2 id="暂停uhttpd服务">暂停uhttpd服务</h2>
<p>uhttpd服务占用了80端口，需要先暂停。使用ssh登录openwrt，执行下面命令暂停uhttpd服务：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>/etc/init.d/uhttpd stop
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>/etc/init.d/uhttpd disable
</span></span></code></pre></div><h2 id="下载caddy">下载caddy</h2>
<p>额外功能模块选上<code>aksdb/caddy-cgi/v2</code></p></div>
				
				
				<div class="read-more">
				  <a href="/posts/openwrt/replace_uhttp_with_caddy/">查看更多…</a>
				</div>
				
            

        </div>
        
    
        
        
        <div class="item" >
           
            
            <a href="https://blog.akvicor.com/posts/openwrt/compile/">
                <span> <img src="/imgs/icons/post-3.svg" width="16" /> </span>
                <span> Compile <sup></sup></span>
            </a>

            
            <div class="desc">
                <span class="date">
                    
                    
                    2023-06-26
                </span>
                <span class="date">
                    
                    
                    - 2024-09-18
                </span>
            </div>
            
            
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/openwrt">OpenWrt</a>
			
		</div>
		<div class="tag">
			
			
			
		</div>
	</div>
</div><div class="summary"><h2 id="平台">平台</h2>
<ul>
<li>Ubuntu 20.04.6 LTS</li>
</ul>
<h2 id="编译环境">编译环境</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>sudo apt update -y
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>sudo apt full-upgrade -y
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>sudo apt install -y ack antlr3 asciidoc autoconf automake autopoint binutils bison build-essential <span style="color:#0a3069">\
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#0a3069"></span>bzip2 ccache cmake cpio curl device-tree-compiler fastjar flex gawk gettext gcc-multilib g++-multilib <span style="color:#0a3069">\
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#0a3069"></span>git gperf haveged help2man intltool libc6-dev-i386 libelf-dev libglib2.0-dev libgmp3-dev libltdl-dev <span style="color:#0a3069">\
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span><span style="color:#0a3069"></span>libmpc-dev libmpfr-dev libncurses5-dev libncursesw5-dev libreadline-dev libssl-dev libtool lrzsz <span style="color:#0a3069">\
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#0a3069"></span>mkisofs msmtp nano ninja-build p7zip p7zip-full patch pkgconf python2.7 python3 python3-pyelftools <span style="color:#0a3069">\
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span><span style="color:#0a3069"></span>libpython3-dev qemu-utils rsync scons squashfs-tools subversion swig texinfo uglifyjs upx-ucl unzip <span style="color:#0a3069">\
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span><span><span style="color:#0a3069"></span>vim wget xmlto xxd zlib1g-dev
</span></span></code></pre></div><h2 id="编译openwrt">编译OpenWrt</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#57606a"># 下载</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>git clone https://github.com/coolsnowwolf/lede <span style="color:#0550ae">&amp;&amp;</span> <span style="color:#6639ba">cd</span> lede
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#57606a"># 添加其他源</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span><span style="color:#6639ba">echo</span> <span style="color:#0a3069">&#34;src-git kenzo https://github.com/kenzok8/openwrt-packages&#34;</span> &gt;&gt; feeds.conf.default
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style="color:#6639ba">echo</span> <span style="color:#0a3069">&#34;src-git small https://github.com/kenzok8/small&#34;</span> &gt;&gt; feeds.conf.default
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span><span style="color:#57606a"># 更新源</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>./scripts/feeds update -a
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>./scripts/feeds install -a
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#57606a"># 修改默认IP为 10.0.0.2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>sed -i <span style="color:#0a3069">&#39;s/192.168.1.1/172.16.1.1/g&#39;</span> package/base-files/files/bin/config_generate
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span><span style="color:#57606a"># 修改默认主机名</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>sed -i <span style="color:#0a3069">&#39;/uci commit system/i\uci set system.@system[0].hostname=&#39;</span>op<span style="color:#0a3069">&#39;&#39;</span> package/lean/default-settings/files/zzz-default-settings
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span><span style="color:#57606a"># 加入编译者信息</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>sed -i <span style="color:#0a3069">&#34;s/OpenWrt /Akvicor build </span><span style="color:#cf222e">$(</span><span style="color:#953800">TZ</span><span style="color:#0550ae">=</span>UTC-8 date <span style="color:#0a3069">&#34;+%Y.%m.%d&#34;</span><span style="color:#cf222e">)</span><span style="color:#0a3069"> @ OpenWrt /g&#34;</span> package/lean/default-settings/files/zzz-default-settings
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span><span style="color:#57606a"># 修改banner</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span><span style="color:#6639ba">echo</span> -e <span style="color:#0a3069">&#34;-------------------------------------------\n %D %V, %C\n-------------------------------------------&#34;</span> &gt; package/base-files/files/etc/banner
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span><span style="color:#57606a"># 修改IPSec VPN账户名</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>sed -i <span style="color:#0a3069">&#34;s/ &#39;lean&#39;/ &#39;akvicor&#39;/g&#34;</span> feeds/luci/applications/luci-app-ipsec-vpnd/root/etc/config/ipsec
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span><span style="color:#57606a"># 配置</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>make menuconfig
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span><span style="color:#57606a"># 修改分区大小</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>Target Images -&gt; Kernel partition size -&gt; <span style="color:#0550ae">64</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>Target Images -&gt; Root filesystem partition size -&gt; <span style="color:#0550ae">4096</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span><span style="color:#57606a"># 添加编程语言支持</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>Languages -&gt; Go -&gt; golang -&gt; on
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span><span style="color:#57606a"># 关闭adbyby plus</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>LuCI -&gt; 3. Applications -&gt; luci-app-adbyby-plus -&gt; off
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span><span style="color:#57606a"># 添加AdguardHome</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>LuCI -&gt; 3. Applications -&gt; luci-app-adguardhome -&gt; on
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span><span style="color:#57606a"># 添加EQOS</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span>LuCI -&gt; 3. Applications -&gt; luci-app-eqos -&gt; on
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span><span style="color:#57606a"># 添加Passwall代理</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span>LuCI -&gt; 3. Applications -&gt; luci-app-passwall -&gt; on
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span><span style="color:#57606a"># 添加方糖气球 serverchan</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span>LuCI -&gt; 3. Applications -&gt; luci-app-serverchan -&gt; on
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span><span style="color:#57606a"># 添加watchcat</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span>LuCI -&gt; 3. Applications -&gt; luci-app-watchcat -&gt; on
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span><span style="color:#57606a"># 关闭迅雷快鸟</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span>LuCI -&gt; 3. Applications -&gt; luci-app-xlnetacc -&gt; off
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span><span><span style="color:#57606a"># 关闭zerotier (一个开源VPN服务，但是需要通过第三方网站使用</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span><span>LuCI -&gt; 3. Applications -&gt; luci-app-zerotier -&gt; off
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span><span><span style="color:#57606a"># 下载</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span><span>make download -j8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span><span><span style="color:#57606a"># 编译</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span><span>screen -S build
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span><span>make <span style="color:#953800">V</span><span style="color:#0550ae">=</span>s -j1
</span></span></code></pre></div><h2 id="在esxi测试">在esxi测试</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#57606a"># 上传vmdk文件</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#57606a"># ssh连接esxi</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#6639ba">cd</span> /vmfs/volumes/hhd/op
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>ls *.vmdk
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>vmkfstools -i openwrt-x86-64-generic-squashfs-combined-efi.vmdk opd.vmdk
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>vmkfstools -X 5120M opd.vmdk <span style="color:#57606a"># 需大于源文件大小</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#57606a"># 更换op虚拟机的硬盘文件</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#57606a"># 配置测试网络</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>vim /etc/config/network
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#57606a"># 修改lan的ip地址</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#57606a"># 重启网络，通过浏览器访问</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>/etc/init.d/network restart
</span></span></code></pre></div></div>
				
            

        </div>
        
    
        
        
        <div class="item" >
           
            
            <a href="https://blog.akvicor.com/posts/openwrt/adguard_home/">
                <span> <img src="/imgs/icons/post-3.svg" width="16" /> </span>
                <span> AdGuard Home <sup></sup></span>
            </a>

            
            <div class="desc">
                <span class="date">
                    
                    
                    2023-06-26
                </span>
                <span class="date">
                    
                    
                    - 2024-09-18
                </span>
            </div>
            
            
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/openwrt">OpenWrt</a>
			
		</div>
		<div class="tag">
			
			
			
		</div>
	</div>
</div><div class="summary"><h2 id="配置">配置</h2>
<ul>
<li>端口：<code>11004</code></li>
<li>5553重定向：使用53端口替换dnsmasq</li>
<li>执行文件路径：<code>/viry/serv/AdGuardHome/exec/AdGuardHome</code></li>
<li>配置文件路径：<code>/viry/serv/AdGuardHome/data/AdGuardHome.yaml</code></li>
<li>工作目录：<code>/viry/serv/AdGuardHome</code></li>
<li>运行日志路径：<code>/viry/serv/AdGuardHome/data/AdGuardHome.log</code></li>
</ul>
<h2 id="无法更新内核">无法更新内核</h2>
<p>问题出在默认执行文件路径不对，将执行文件路径修改为 <code>/usr/bin/AdGuardHome/AdGuardHome</code></p></div>
				
				
				<div class="read-more">
				  <a href="/posts/openwrt/adguard_home/">查看更多…</a>
				</div>
				
            

        </div>
        
    
        
        
        <div class="item" >
           
            
            <a href="https://blog.akvicor.com/posts/openwrt/esxi/">
                <span> <img src="/imgs/icons/post-3.svg" width="16" /> </span>
                <span> vmdk for ESXi <sup></sup></span>
            </a>

            
            <div class="desc">
                <span class="date">
                    
                    
                    2023-05-05
                </span>
                <span class="date">
                    
                    
                    - 2024-09-18
                </span>
            </div>
            
            
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/openwrt">OpenWrt</a>
			
		</div>
		<div class="tag">
			
			
			
		</div>
	</div>
</div><div class="summary"><h2 id="开启ssh">开启SSH</h2>
<p>管理 -&gt; 服务 -&gt; TSM-SSH</p>
<p>使用SSH登录到ESXI</p>
<h2 id="修改的固件vmdk大小">修改的固件vmdk大小</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#6639ba">cd</span> /vmfs/volumes/datastore1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>ls *.vmdk
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>vmkfstools -i openwrt.vmdk 123.vmdk
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>vmkfstools -X 1024M 123.vmdk <span style="color:#57606a"># 需大于源文件大小</span>
</span></span></code></pre></div><h2 id="添加硬盘">添加硬盘</h2>
<p>根据实际情况选择EFI或BIOS引导</p></div>
				
            

        </div>
        
    
        
        
        <div class="item" >
           
            
            <a href="https://blog.akvicor.com/posts/openwrt/enable_https/">
                <span> <img src="/imgs/icons/post-3.svg" width="16" /> </span>
                <span> Enable HTTPS <sup></sup></span>
            </a>

            
            <div class="desc">
                <span class="date">
                    
                    
                    2023-01-29
                </span>
                <span class="date">
                    
                    
                    - 2024-09-18
                </span>
            </div>
            
            
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/openwrt">OpenWrt</a>
			
		</div>
		<div class="tag">
			
			
			
		</div>
	</div>
</div><div class="summary"><p>修改uhttpd配置文件 <code>/etc/config/uhttpd</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>option cert /viry/cert/akvicor.com.crt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>option key /viry/cert/akvicor.com.key
</span></span></code></pre></div><p>重启uhttpd服务 <code>/etc/init.d/uhttpd restart</code></p></div>
				
            

        </div>
        
    
        
        
        <div class="item" >
           
            
            <a href="https://blog.akvicor.com/posts/openwrt/lpthread/">
                <span> <img src="/imgs/icons/post-3.svg" width="16" /> </span>
                <span> /usr/bin/ld: cannot find -lpthread <sup></sup></span>
            </a>

            
            <div class="desc">
                <span class="date">
                    
                    
                    2022-11-17
                </span>
                <span class="date">
                    
                    
                    - 2024-09-18
                </span>
            </div>
            
            
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/openwrt">OpenWrt</a>
			
		</div>
		<div class="tag">
			
			
			
		</div>
	</div>
</div><div class="summary"><p>使用golang编译程序遇到的问题</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span># runtime/cgo
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>/usr/bin/ld: cannot find -lpthread
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>collect2: error: ld returned 1 exit status
</span></span></code></pre></div><p>pthread primitives are part of the core libc.so library. to satisfy <code>-lpthread</code>, create an empty AR archive somewhere in the library search path.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>ar -rc /usr/lib/libpthread.a
</span></span></code></pre></div></div>
				
            

        </div>
        
    
        
        
        <div class="item" >
           
            
            <a href="https://blog.akvicor.com/posts/openwrt/squashfs_resize/">
                <span> <img src="/imgs/icons/post-3.svg" width="16" /> </span>
                <span> squashfs镜像扩容 <sup></sup></span>
            </a>

            
            <div class="desc">
                <span class="date">
                    
                    
                    2022-11-16
                </span>
                <span class="date">
                    
                    
                    - 2024-09-18
                </span>
            </div>
            
            
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/openwrt">OpenWrt</a>
			
		</div>
		<div class="tag">
			
			
			
		</div>
	</div>
</div><div class="summary">此方法仅适合刚把镜像写入磁盘还未启动以及还未将镜像写入磁盘这两种情况，一旦系统启动，squashfs分区大小就已经确定了，如果要更改只能使用losetup挂载并执行resize.f2fs扩展大小。</div>
				
				
				<div class="read-more">
				  <a href="/posts/openwrt/squashfs_resize/">查看更多…</a>
				</div>
				
            

        </div>
        
    
    </div>

    <div class="container-pagination">
    
    </div>
</div>

        </div>
        <div id="footer"><div class="container-footer">
    
    
    <a href="https://icp.gov.moe/?keyword=20250177" target="_blank">
        萌ICP备20250177号
    </a>
    
    
    <a href="/" target="_blank">
        <span class="some">世界一、 幸せな女の子だ<span>
    </a>
    <a id="s" href="/secrets">&nbsp;</a>
    
</div></div>
    </body>
</html>
